import json

from jsonschema import FormatChecker, validate
def validate_multikeypoint(data: dict):
    schema_for_multikeypoint = {
        "type": "object",
        "properties": {
            "bboxes": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "box": {
                            "type": "array",
                            "items": {
                                "type": "array",
                                "items": {"type": "number", "exclusiveMinimum": 0},
                                "minItems": 2,
                                "maxItems": 2,
                            },
                            "minItems": 2,
                            "maxItems": 8
                        },
                        "pk": {"type": "string", "format": "uuid"},
                        "class": {"type": "integer", "minimum": 0},
                        "boxtype": {"type": "string", "const": "lines"},
                    },
                    "required": ["box", "class"],
                    "additionalProperties": False,
                },
            },
            "image": {
                "type": "object",
                "properties": {
                    "rotation": {"type": "integer"},
                    "image_width": {"type": "integer", "exclusiveMinimum": 0},
                    "image_height": {"type": "integer", "exclusiveMinimum": 0},
                },
            },
        },
        "required": ["bboxes"],
    }

    format_checker = FormatChecker()
    try:
        validate(data, schema_for_multikeypoint, format_checker=format_checker)
        return True
    except Exception as e:
        # later return error message
        print(e)
        return False


#data = '{"bboxes": [{"box": [[365, 429], [375, 423], [375, 423], [357, 420], [357, 420], [341, 420], [341, 420], [317, 463]], "pk": "8d84f4f2-a3f7-4c81-a68d-c627870d8714", "class": 0, "boxtype": "lines"}, {"box": [[365, 429], [357, 420]], "pk": "e9cb57e6-6128-49b2-8903-32382d4f43f9", "class": 0, "boxtype": "lines"}, {"box": [[375, 423], [386, 427], [386, 427], [402, 464]], "pk": "2aa4444a-2c10-4053-85b7-2c8f793189f2", "class": 0, "boxtype": "lines"}, {"box": [[402, 464], [317, 463], [317, 463], [303, 519]], "pk": "8b1c0a06-298d-45e0-8090-51db1465a101", "class": 1, "boxtype": "lines"}, {"box": [[402, 464], [442, 505], [442, 505], [414, 505]], "pk": "32e18b33-02e2-4d83-9da8-5a9bc3630093", "class": 1, "boxtype": "lines"}, {"box": [[303, 519], [352, 524]], "pk": "cd78755b-996f-4cae-a59b-b21db94c382c", "class": 1, "boxtype": "lines"}, {"box": [[280, 577], [376, 531], [376, 531], [382, 558]], "pk": "428776e2-13a3-4aa4-85fb-352f3d6c3819", "class": 2, "boxtype": "lines"}, {"box": [[322, 700], [314, 594], [314, 594], [331, 568]], "pk": "e1db0a28-5205-4587-9d0a-08c5606d3860", "class": 2, "boxtype": "lines"}, {"box": [[402, 464], [382, 558], [382, 558], [331, 568]], "pk": "8075ef29-33b7-4dbf-808c-67368267ac00", "class": 3, "boxtype": "lines"}, {"box": [[317, 463], [331, 568]], "pk": "5137e526-e0a3-4bdd-8080-293a33bd23e8", "class": 3, "boxtype": "lines"}, {"box": [[504, 319], [512, 310], [512, 310], [495, 312], [495, 312], [487, 315], [487, 315], [479, 358]], "pk": "9e0fa343-ab24-4592-bae0-b5f47125817c", "class": 0, "boxtype": "lines"}, {"box": [[504, 319], [495, 312]], "pk": "23a33c31-c3e6-4d4b-bb9e-3834875a9219", "class": 0, "boxtype": "lines"}, {"box": [[512, 310], [528, 310], [528, 310], [548, 356]], "pk": "bd4c91a0-672f-4c30-b6f8-82ef5888a2bb", "class": 0, "boxtype": "lines"}, {"box": [[548, 356], [479, 358], [479, 358], [460, 410]], "pk": "451303e7-6a7e-4340-b6b5-23a509b94c18", "class": 1, "boxtype": "lines"}, {"box": [[548, 356], [557, 420], [557, 420], [550, 472]], "pk": "69e26ee4-1290-417e-9add-f9fda3fcd550", "class": 1, "boxtype": "lines"}, {"box": [[460, 410], [433, 446]], "pk": "00c9a710-8202-4489-b84b-a308374d228f", "class": 1, "boxtype": "lines"}, {"box": [[533, 631], [534, 551], [534, 551], [537, 466]], "pk": "d2f15a28-09ca-4bab-9dff-c354e3730a75", "class": 2, "boxtype": "lines"}, {"box": [[509, 632], [502, 551], [502, 551], [495, 466]], "pk": "90433301-e59b-4e4c-9ec2-6b9745e053e0", "class": 2, "boxtype": "lines"}, {"box": [[548, 356], [537, 466], [537, 466], [495, 466]], "pk": "7f7f16de-e914-4bde-919c-e6053af60078", "class": 3, "boxtype": "lines"}, {"box": [[479, 358], [495, 466]], "pk": "3c0d91f7-127a-49a7-8721-f0240ddd889e", "class": 3, "boxtype": "lines"}, {"box": [[183, 223], [192, 214], [192, 214], [173, 215], [173, 215], [160, 220], [160, 220], [136, 280]], "pk": "775be4a0-008f-4084-a2d6-b17361c5ff98", "class": 0, "boxtype": "lines"}, {"box": [[183, 223], [173, 215]], "pk": "e622131c-298b-4bca-9dae-21fea0a25302", "class": 0, "boxtype": "lines"}, {"box": [[192, 214], [205, 220], [205, 220], [226, 282]], "pk": "c5b4dc2c-e39b-4448-8891-f386b650323c", "class": 0, "boxtype": "lines"}, {"box": [[226, 282], [136, 280], [136, 280], [121, 357]], "pk": "95b564b1-e057-4dfb-a93b-a0d3c85c488f", "class": 1, "boxtype": "lines"}, {"box": [[226, 282], [242, 362], [242, 362], [214, 407]], "pk": "bdf74aa9-8f7f-4ef8-9df4-6b2b45c06ec2", "class": 1, "boxtype": "lines"}, {"box": [[121, 357], [150, 396]], "pk": "a04ed1cd-97aa-4ed1-9d0d-10fed87cf551", "class": 1, "boxtype": "lines"}, {"box": [[227, 624], [213, 528], [213, 528], [206, 429]], "pk": "c0f1e2b1-5c60-4bea-ab03-0298bf5d92f2", "class": 2, "boxtype": "lines"}, {"box": [[154, 625], [149, 529], [149, 529], [146, 428]], "pk": "a78cefc6-8f8d-4656-9ab5-768eb626f392", "class": 2, "boxtype": "lines"}, {"box": [[226, 282], [206, 429], [206, 429], [146, 428]], "pk": "f86b347e-3753-4348-9303-0d132435660a", "class": 3, "boxtype": "lines"}, {"box": [[136, 280], [146, 428]], "pk": "dd56752b-6d4d-47ef-b4ca-e48e941e5c1d", "class": 3, "boxtype": "lines"}, {"box": [[737, 415], [746, 409], [746, 409], [730, 406], [730, 406], [714, 404], [714, 404], [680, 433]], "pk": "14850a01-fa25-4eb2-a1c2-11c81c8613a4", "class": 0, "boxtype": "lines"}, {"box": [[737, 415], [730, 406]], "pk": "56317be4-ae8c-4eee-8310-7a551ddfcd68", "class": 0, "boxtype": "lines"}, {"box": [[758, 443], [680, 433], [680, 433], [658, 492]], "pk": "507392ce-97cd-486a-85d0-95c380316e2d", "class": 1, "boxtype": "lines"}, {"box": [[758, 443], [754, 502], [754, 502], [739, 539]], "pk": "0c14f9d6-f15c-4704-aa41-5d550216251f", "class": 1, "boxtype": "lines"}, {"box": [[658, 492], [697, 540]], "pk": "534dceaa-a513-41ff-9d7b-9841e6561580", "class": 1, "boxtype": "lines"}, {"box": [[744, 697], [739, 589], [739, 589], [727, 528]], "pk": "ccd7e2b4-8174-4637-8a8d-d95ee8019075", "class": 2, "boxtype": "lines"}, {"box": [[681, 695], [678, 587], [678, 587], [674, 526]], "pk": "d8fbe43f-99a1-45ee-a096-c649ef205de0", "class": 2, "boxtype": "lines"}, {"box": [[758, 443], [727, 528], [727, 528], [674, 526]], "pk": "b24fd192-4200-43cb-8e92-776c484404a3", "class": 3, "boxtype": "lines"}, {"box": [[680, 433], [674, 526]], "pk": "2fde9463-d868-45fc-b092-801334f1d1d2", "class": 3, "boxtype": "lines"}, {"box": [[583, 267], [591, 259], [591, 259], [576, 261]], "pk": "439972ac-8ccf-49bf-adb5-c480becf2acc", "class": 0, "boxtype": "lines"}, {"box": [[583, 267], [576, 261]], "pk": "bc3c73b1-ee39-41fa-8ae4-ac815c6a0141", "class": 0, "boxtype": "lines"}, {"box": [[591, 259], [610, 263], [610, 263], [638, 315]], "pk": "1e75fec5-6875-4b13-9218-4604e4fef632", "class": 0, "boxtype": "lines"}, {"box": [[638, 315], [561, 315]], "pk": "fe9a72b7-d5b9-40c8-a97c-f6ba6bc0e8e7", "class": 1, "boxtype": "lines"}, {"box": [[638, 315], [657, 383], [657, 383], [654, 446]], "pk": "4353616f-e586-4ad7-9015-dc05f8a5c22d", "class": 1, "boxtype": "lines"}, {"box": [[633, 622], [631, 532], [631, 532], [619, 442]], "pk": "12561425-b6ed-4588-a34a-680e0bf7469a", "class": 2, "boxtype": "lines"}, {"box": [[595, 625], [581, 534], [581, 534], [569, 442]], "pk": "18ae221e-9e42-4a3a-a8e3-33bbde302e66", "class": 2, "boxtype": "lines"}, {"box": [[638, 315], [619, 442], [619, 442], [569, 442]], "pk": "c1dfe7bc-d7d2-49b3-89d1-e6da3aeb27b9", "class": 3, "boxtype": "lines"}, {"box": [[561, 315], [569, 442]], "pk": "4f2da42b-4b3f-4efa-8d4f-0246fd6b2324", "class": 3, "boxtype": "lines"}, {"box": [[297, 235], [304, 227], [304, 227], [286, 228], [286, 228], [268, 234], [268, 234], [247, 292]], "pk": "af517980-3756-41b0-954d-607f2349cdc6", "class": 0, "boxtype": "lines"}, {"box": [[297, 235], [286, 228]], "pk": "3bec464a-ea78-4550-ad85-d766f7aa5b00", "class": 0, "boxtype": "lines"}, {"box": [[335, 287], [247, 292], [247, 292], [233, 368]], "pk": "37426d7c-d289-4b05-9392-dce7c2ae54ec", "class": 1, "boxtype": "lines"}, {"box": [[233, 368], [245, 431]], "pk": "35d492e9-4658-4bea-840c-ce1e4cb1def2", "class": 1, "boxtype": "lines"}, {"box": [[319, 534], [326, 437]], "pk": "ebb917d9-2624-4333-bfca-d46e314a64cf", "class": 2, "boxtype": "lines"}, {"box": [[274, 620], [277, 535], [277, 535], [270, 439]], "pk": "f3cec462-8ce3-408d-8a11-a66fa671aee7", "class": 2, "boxtype": "lines"}, {"box": [[335, 287], [326, 437], [326, 437], [270, 439]], "pk": "73c590b0-7842-48a3-8b34-e51148c43357", "class": 3, "boxtype": "lines"}, {"box": [[247, 292], [270, 439]], "pk": "daa7e96a-b964-41bd-ae60-561a00030059", "class": 3, "boxtype": "lines"}, {"box": [[788, 305], [796, 298], [796, 298], [781, 298]], "pk": "59ed6d8f-ac00-4fa0-b3b2-4b824ad42749", "class": 0, "boxtype": "lines"}, {"box": [[788, 305], [781, 298]], "pk": "d32d9797-1499-41c7-b3ba-16a69adb0b30", "class": 0, "boxtype": "lines"}, {"box": [[796, 298], [810, 302], [810, 302], [824, 347]], "pk": "4a8a99d8-8f78-417c-a832-dc7c197856ee", "class": 0, "boxtype": "lines"}, {"box": [[824, 347], [766, 347]], "pk": "cee57a4d-9028-44b7-af75-e80e13ce9fe0", "class": 1, "boxtype": "lines"}, {"box": [[824, 347], [836, 409], [836, 409], [808, 460]], "pk": "83c03566-737e-445a-a419-53d080381e9b", "class": 1, "boxtype": "lines"}, {"box": [[823, 634], [807, 549], [807, 549], [812, 465]], "pk": "48c83dc5-49a6-4db0-9301-feef09718c63", "class": 2, "boxtype": "lines"}, {"box": [[795, 628], [781, 550], [781, 550], [775, 465]], "pk": "d54cfb33-4ceb-4181-98aa-353cc759e87a", "class": 2, "boxtype": "lines"}, {"box": [[824, 347], [812, 465], [812, 465], [775, 465]], "pk": "bdb05c98-0f5e-4673-a931-c44e130fa232", "class": 3, "boxtype": "lines"}, {"box": [[766, 347], [775, 465]], "pk": "d74830cd-f4d6-4cff-8b3a-c2a54ebad65e", "class": 3, "boxtype": "lines"}, {"box": [[408, 285], [416, 277], [416, 277], [401, 277], [401, 277], [388, 277], [388, 277], [369, 322]], "pk": "ae4ccf9c-d173-479f-93ae-1544b0c0f6b4", "class": 0, "boxtype": "lines"}, {"box": [[408, 285], [401, 277]], "pk": "2d29ab81-1557-45b2-b77f-9f368818174f", "class": 0, "boxtype": "lines"}, {"box": [[416, 277], [428, 277], [428, 277], [451, 322]], "pk": "b94be64b-db1e-4a1b-acd4-a94b9f2e08ea", "class": 0, "boxtype": "lines"}, {"box": [[451, 322], [369, 322]], "pk": "6d165563-5bf2-4ce5-ad9f-20cc250390d6", "class": 1, "boxtype": "lines"}, {"box": [[451, 322], [470, 384], [470, 384], [428, 373]], "pk": "f4d2eb0d-b180-4c4f-a061-5a43cc43d63a", "class": 1, "boxtype": "lines"}, {"box": [[431, 540], [434, 447]], "pk": "34716b18-967b-4dd2-b39a-897291603fed", "class": 2, "boxtype": "lines"}, {"box": [[380, 537], [379, 446]], "pk": "08ce66ce-d9af-4a39-b6ad-8aea34ec22f5", "class": 2, "boxtype": "lines"}, {"box": [[451, 322], [434, 447], [434, 447], [379, 446]], "pk": "6d28a537-738a-4de3-b509-b4da0f88d4e3", "class": 3, "boxtype": "lines"}, {"box": [[369, 322], [379, 446]], "pk": "73e76c4f-eaf6-494a-a05d-b981d4d18926", "class": 3, "boxtype": "lines"}, {"box": [[685, 272], [694, 265], [694, 265], [678, 264], [678, 264], [668, 267], [668, 267], [648, 316]], "pk": "a3ca41a9-0cdc-4564-81bb-a4a0e39cf07d", "class": 0, "boxtype": "lines"}, {"box": [[685, 272], [678, 264]], "pk": "e92d15f2-45fa-4d7f-b765-81a5f9408e4d", "class": 0, "boxtype": "lines"}, {"box": [[694, 265], [707, 269], [707, 269], [730, 322]], "pk": "785252c6-06df-429f-8ee3-cc46e2a1bb5b", "class": 0, "boxtype": "lines"}, {"box": [[730, 322], [648, 316]], "pk": "e27287a5-f322-45fb-a32d-2f718a3f1b0a", "class": 1, "boxtype": "lines"}, {"box": [[730, 322], [740, 390]], "pk": "4530ff2c-4ee1-41ad-9bd6-9782ec636755", "class": 1, "boxtype": "lines"}, {"box": [[730, 322], [710, 436], [710, 436], [656, 433]], "pk": "abaff0e5-6553-4f0a-ade6-354a213090a7", "class": 3, "boxtype": "lines"}, {"box": [[648, 316], [656, 433]], "pk": "99bb3f7d-8ff0-45bf-807a-d34379a8383d", "class": 3, "boxtype": "lines"}], "image": {"rotation": 0, "image_width": 1000, "image_height": 761}}'


data = '{"bboxes": [{"box": [[1,1],[489,334]],"pk": "53286e40-2b2f-42ec-88c4-0593e93bb812","class": 1,"boxtype": "lines"},{"box": [[1,1],[1,1]],"pk": "53286e40-2b2f-42ec-88c4-0593e93bb812","class": 1,"boxtype": "lines"},{"box": [[1,1],[1,1]],"pk": "53286e40-2b2f-42ec-88c4-0593e93bb812","class": 1,"boxtype": "lines"},{"box": [[1,1],[340,368]],"pk": "53286e40-2b2f-42ec-88c4-0593e93bb812","class": 1,"boxtype": "lines"},{"box": [[1,1],[1,1]],"pk": "53286e40-2b2f-42ec-88c4-0593e93bb812","class": 1,"boxtype": "lines"},{"box": [[1,1],[282,374]],"pk": "53286e40-2b2f-42ec-88c4-0593e93bb812","class": 1,"boxtype": "lines"},{"box": [[336,192],[392,354]],"pk": "53286e40-2b2f-42ec-88c4-0593e93bb812","class": 1,"boxtype": "lines"},{"box": [[1,1],[115,377]],"pk": "53286e40-2b2f-42ec-88c4-0593e93bb812","class": 1,"boxtype": "lines"}],"image": {"rotation": 0,"image_width": 640,"image_height": 427}}'

print("Validated", validate_multikeypoint(json.loads(data)))
